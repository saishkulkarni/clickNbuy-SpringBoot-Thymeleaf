<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <div align="center">
        <h1>Cart Items</h1>

        <table border="1">
            <tr>
                <th>Name</th>
                <th>Image</th>
                <th>Stock</th>
                <th>Price</th>
                <th>Reduce</th>
                <th>Quantity</th>
                <th>Increase</th>
                <th>Price</th>
            </tr>
            <tr th:each="item:${items}">
                <td th:text="${item.product.name}"></td>
                <td><img th:src="${item.product.imageLink}" height="100px" width="100px"></td>
                <td th:text="${item.product.stock}"></td>
                <td th:text="${item.product.price+'&#8377'}"></td>
                <td><a th:href="'/user/cart/decrease/'+${item.id}"><button>-</button></a></td>
                <td th:text="${item.quantity}"></td>
                <td><a th:href="'/user/cart/increase/'+${item.id}"><button>+</button></a></td>
                <td th:text="${item.quantity*item.product.price+'&#8377'}"></td>
            </tr>
            <tr>
                <td colspan="7"></td>
                <td>Total Price: 
					<span th:text="${total+'&#8377'}"></span>
				</td> 
            </tr>
			<tr>
			                <td colspan="7"></td>
			                <td><a href="/user/checkout"><button>Proceed to Checkout</button></a>
							</td> 
			            </tr>
        </table>
		<br>
        <a href="/"><button>Back</button></a>
    </div>
	
	<!-- Toast Container -->
	<div class="toast-container" id="toastContainer"></div>

	<!-- Bootstrap JS -->
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

	<script th:inline="javascript">
	    let successMessage = [[${success != null}]] ? '[[${success}]]' : null;
	    let errorMessage = [[${error != null}]] ? '[[${error}]]' : null;

	    function showToast(message, type='success') {
	        if (!message) return;
	        const toastHTML = `
	        <div class="toast align-items-center text-bg-${type} border-0 mb-2" role="alert" aria-live="assertive" aria-atomic="true">
	            <div class="d-flex">
	                <div class="toast-body">${message}</div>
	                <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
	            </div>
	        </div>`;
	        const container = document.getElementById('toastContainer');
	        container.insertAdjacentHTML('beforeend', toastHTML);
	        const toastEl = container.lastElementChild;
	        const toast = new bootstrap.Toast(toastEl);
	        toast.show();
	    }

	    showToast(successMessage, 'success');
	    showToast(errorMessage, 'danger');
	</script>
</body>

</html>